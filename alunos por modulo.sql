SELECT
DISTINCT
SMATRICPL.RA,
PPESSOA.NOME, 
(SELECT CODTURMA FROM SMATRICPL SMP WHERE SMP.PERIODO = 1 AND SMP.RA = SMATRICPL.RA) AS 'MODULO I',
(SELECT CODTURMA FROM SMATRICPL SMP WHERE SMP.PERIODO = 2 AND SMP.RA = SMATRICPL.RA) AS 'MODULO II',
(SELECT CODTURMA FROM SMATRICPL SMP WHERE SMP.PERIODO = 3 AND SMP.RA = SMATRICPL.RA) AS 'MODULO III',
ISNULL((SELECT CODTURMA FROM SMATRICPL SMP WHERE SMP.PERIODO = 4 AND SMP.RA = SMATRICPL.RA),'NÃO ENCONTRADA') AS 'MODULO IV'

FROM SMATRICPL
INNER JOIN SALUNO ON SALUNO.CODCOLIGADA = SMATRICPL.CODCOLIGADA AND SALUNO.RA = SMATRICPL.RA
INNER JOIN PPESSOA ON PPESSOA.CODIGO = SALUNO.CODPESSOA

WHERE SMATRICPL.CODCOLIGADA = 3 AND SMATRICPL.RA IN ('0033328','0033396','0033455','0033470','0033483','0033512','0033594','0033641','0033678','0033683','0033755','0033764','0033854','0033860','0034199','0035440','0035632','0016115','0033644')